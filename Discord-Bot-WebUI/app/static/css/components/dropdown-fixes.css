/**
 * ============================================================================
 * DROPDOWN CONTEXTUAL FIXES
 * ============================================================================
 *
 * Context-specific dropdown fixes for tables, cards, modals, and third-party
 * components. These rules handle overflow and z-index for specific contexts.
 *
 * NOTE: Base dropdown styling is in dropdowns.css (authoritative source).
 * This file ONLY contains context-specific overrides.
 *
 * ============================================================================
 */

/* ============================================================================
   TABLE DROPDOWN FIXES
   Allow dropdowns to escape table scroll containers
   ============================================================================ */

/* Tables with dropdowns need overflow visible when open */
.c-table-wrapper:has(.dropdown.show),
.table-responsive:has(.dropdown.show) {
  overflow: visible;
}

/* Allow dropdowns to escape table scroll containers */
.table-responsive {
  overflow-x: auto;
  overflow-y: visible;
}

/* Action dropdowns in table cells need higher z-index */
td .dropdown-menu,
.c-table__cell .dropdown-menu {
  z-index: var(--z-modal-dropdown, 1055);
}

/* Ensure dropdown parent cells allow overflow */
td:has(.dropdown),
.c-table__cell:has(.dropdown) {
  overflow: visible;
  position: relative;
}

/* ============================================================================
   CARD DROPDOWN FIXES
   ============================================================================ */

/* Cards containing dropdowns */
.c-card:has(.dropdown.show) {
  overflow: visible;
}

.c-card__header .dropdown-menu {
  z-index: var(--z-modal-dropdown, 1055);
}

/* ============================================================================
   SIDEBAR DROPDOWN FIXES
   ============================================================================ */

.c-sidebar {
  z-index: var(--z-sidebar, 1035);
}

.c-sidebar__submenu {
  position: relative;
  z-index: calc(var(--z-sidebar, 1035) + 1);
}

/* ============================================================================
   THIRD-PARTY COMPONENT Z-INDEX
   Ensure dropdowns from Select2, Tagify, Flatpickr appear above content
   ============================================================================ */

.select2-container--open {
  z-index: var(--z-popover, 1040);
}

.select2-dropdown {
  z-index: var(--z-popover, 1040);
}

.tagify__dropdown {
  z-index: var(--z-popover, 1040);
}

.flatpickr-calendar {
  z-index: var(--z-popover, 1040);
}

.bootstrap-datetimepicker-widget {
  z-index: var(--z-popover, 1040);
}

/* ============================================================================
   ACCESSIBILITY
   ============================================================================ */

@media (prefers-reduced-motion: reduce) {
  .dropdown-menu.show {
    animation: none;
  }
}
