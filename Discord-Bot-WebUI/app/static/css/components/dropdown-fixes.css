/**
 * ============================================================================
 * DROPDOWN CONTEXTUAL FIXES
 * ============================================================================
 *
 * Context-specific dropdown fixes for tables, cards, modals, and third-party
 * components. These rules handle overflow and z-index for specific contexts.
 *
 * NOTE: Base dropdown styling is in dropdowns.css (authoritative source).
 * This file ONLY contains context-specific overrides.
 *
 * ============================================================================
 */

/* ============================================================================
   TABLE DROPDOWN FIXES
   Allow dropdowns to escape table scroll containers
   ============================================================================ */

/* Tables with dropdowns need overflow visible when open */
/* CSS :has() selector for modern browsers */
.c-table-wrapper:has(.dropdown.show),
.table-responsive:has(.dropdown.show),
.c-table-wrapper:has(.dropdown-menu.show),
.table-responsive:has(.dropdown-menu.show) {
  overflow: visible ;
  overflow-x: visible;
  overflow-y: visible;
}

/* JavaScript fallback class for older browsers */
.c-table-wrapper.dropdown-open,
.table-responsive.dropdown-open {
  overflow: visible ;
  overflow-x: visible;
  overflow-y: visible;
}

/* Card body containing table with open dropdown */
.c-card__body:has(.dropdown.show),
.card-body:has(.dropdown.show),
.c-card__body:has(.dropdown-menu.show),
.card-body:has(.dropdown-menu.show) {
  overflow: visible ;
}

/* JavaScript fallback class for card bodies */
.c-card__body.dropdown-open,
.card-body.dropdown-open {
  overflow: visible ;
}

/* Allow dropdowns to escape table scroll containers */
.table-responsive {
  overflow-x: auto;
  overflow-y: visible;
}

/* Action dropdowns in table cells need proper z-index */
td .dropdown-menu.show,
.c-table__cell .dropdown-menu.show,
.user-actions-cell .dropdown-menu.show {
  z-index: var(--z-modal-dropdown, 1055) ;
}

/* Action dropdowns in table cells need higher z-index */
td .dropdown-menu,
.c-table__cell .dropdown-menu {
  z-index: var(--z-modal-dropdown, 1055);
}

/* Ensure dropdown parent cells allow overflow */
td:has(.dropdown),
.c-table__cell:has(.dropdown),
.user-actions-cell {
  overflow: visible ;
  position: static;
}

/* ============================================================================
   CARD DROPDOWN FIXES
   ============================================================================ */

/* Cards containing dropdowns */
.c-card:has(.dropdown.show) {
  overflow: visible;
}

.c-card__header .dropdown-menu {
  z-index: var(--z-modal-dropdown, 1055);
}

/* ============================================================================
   SIDEBAR DROPDOWN FIXES
   NOTE: .c-sidebar z-index moved to layout/sidebar-modern.css
   ============================================================================ */

/* ============================================================================
   THIRD-PARTY COMPONENT Z-INDEX
   Ensure dropdowns from Select2, Tagify, Flatpickr appear above content
   ============================================================================ */

.select2-container--open {
  z-index: var(--z-popover, 1040);
}

.select2-dropdown {
  z-index: var(--z-popover, 1040);
}

.tagify__dropdown {
  z-index: var(--z-popover, 1040);
}

.flatpickr-calendar {
  z-index: var(--z-popover, 1040);
}

.bootstrap-datetimepicker-widget {
  z-index: var(--z-popover, 1040);
}

/* ============================================================================
   ACCESSIBILITY
   ============================================================================ */

@media (prefers-reduced-motion: reduce) {
  .dropdown-menu.show {
    animation: none;
  }
}
