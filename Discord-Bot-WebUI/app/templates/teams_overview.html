{% extends "base.html" %}
{% import 'macros.html' as macros %}

{% block main_content %}
<div class="container-xxl flex-grow-1 container-p-y">
    <!-- Page Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="c-header-modern">
                <div class="c-header-modern__content">
                    <h2 class="c-header-modern__title">Teams Overview</h2>
                    <p class="c-header-modern__subtitle">View all teams across our leagues</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Tabs for different leagues -->
    <!-- Using BEM tabs-controller (not Bootstrap tabs) to avoid conflicts -->
    <div class="row mb-3">
        <div class="col-12">
            <nav class="c-nav-modern c-nav-modern--pills" data-tabs role="tablist">
                <button class="c-nav-modern__link is-active"
                        data-tab-trigger="classic-teams"
                        type="button"
                        role="tab"
                        aria-selected="true"
                        tabindex="0">
                    <i class="ti ti-ball-football c-nav-modern__icon"></i>Classic Division
                </button>
                <button class="c-nav-modern__link"
                        data-tab-trigger="premier-teams"
                        type="button"
                        role="tab"
                        aria-selected="false"
                        tabindex="-1">
                    <i class="ti ti-trophy c-nav-modern__icon"></i>Premier Division
                </button>
                <button class="c-nav-modern__link"
                        data-tab-trigger="ecsfc-teams"
                        type="button"
                        role="tab"
                        aria-selected="false"
                        tabindex="-1">
                    <i class="ti ti-shield c-nav-modern__icon"></i>ECS FC Division
                </button>
            </nav>
        </div>
    </div>

    <!-- Tab Content for Teams -->
    <div class="c-tab-content-modern">
        <!-- Classic Division Teams -->
        <div class="c-tab-pane-modern c-settings-tab--active" id="classic-teams" data-tab-pane="classic-teams" role="tabpanel">
            <div class="row g-3">
                {% set classic_teams = teams | selectattr("league.name", "equalto", "Classic") | list %}
                {% if classic_teams %}
                    {% for team in classic_teams %}
                    <div class="col-xl-4 col-md-6">
                        <div class="c-card-modern c-card-modern--clickable c-card-modern--team c-card-modern--full-height" data-team-id="{{ team.id }}">
                            <div class="c-card-modern__body">
                                <div class="c-card-modern__header-group">
                                    {{ macros.team_avatar(team, 'md', 'bg-primary me-3') }}
                                    <div class="c-card-modern__header-info">
                                        <h5 class="c-card-modern__title">{{ team.name }}</h5>
                                        <p class="c-card-modern__subtitle">
                                            <i class="ti ti-calendar-event c-icon-modern c-icon-modern--small"></i>{{ team.league.season.name }}
                                        </p>
                                    </div>
                                </div>

                                <div class="c-card-modern__meta">
                                    <div class="c-card-modern__meta-group">
                                        <div class="c-card-modern__meta-item">
                                            <i class="ti ti-users c-icon-modern"></i>{{ team.players | length }} Players
                                        </div>
                                        <div class="c-card-modern__meta-item">
                                            <i class="ti ti-trophy c-icon-modern"></i>{{ team.league.name }}
                                        </div>
                                    </div>
                                </div>

                                <a href="{{ url_for('teams.team_details', team_id=team.id) }}"
                                   class="c-btn-modern c-btn-modern--primary c-btn-modern--block"
                                   data-action="view-team"
                                   data-team-id="{{ team.id }}">
                                    <i class="ti ti-eye c-btn-modern__icon"></i>View Team
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="col-12">
                        <div class="c-card-modern">
                            <div class="c-card-modern__body c-card-modern__body--center c-card-modern__body--padded">
                                <div class="c-empty-state-modern">
                                    <div class="c-empty-state-modern__icon">
                                        <i class="ti ti-ball-football"></i>
                                    </div>
                                    <p class="c-empty-state-modern__message">No Classic Division teams available.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>

        <!-- Premier Division Teams -->
        <div class="c-tab-pane-modern c-settings-tab" id="premier-teams" data-tab-pane="premier-teams" role="tabpanel">
            <div class="row g-3">
                {% set premier_teams = teams | selectattr("league.name", "equalto", "Premier") | list %}
                {% if premier_teams %}
                    {% for team in premier_teams %}
                    <div class="col-xl-4 col-md-6">
                        <div class="c-card-modern c-card-modern--clickable c-card-modern--team c-card-modern--full-height" data-team-id="{{ team.id }}">
                            <div class="c-card-modern__body">
                                <div class="c-card-modern__header-group">
                                    {{ macros.team_avatar(team, 'md', 'bg-success me-3') }}
                                    <div class="c-card-modern__header-info">
                                        <h5 class="c-card-modern__title">{{ team.name }}</h5>
                                        <p class="c-card-modern__subtitle">
                                            <i class="ti ti-calendar-event c-icon-modern c-icon-modern--small"></i>{{ team.league.season.name }}
                                        </p>
                                    </div>
                                </div>

                                <div class="c-card-modern__meta">
                                    <div class="c-card-modern__meta-group">
                                        <div class="c-card-modern__meta-item">
                                            <i class="ti ti-users c-icon-modern"></i>{{ team.players | length }} Players
                                        </div>
                                        <div class="c-card-modern__meta-item">
                                            <i class="ti ti-trophy c-icon-modern"></i>{{ team.league.name }}
                                        </div>
                                    </div>
                                </div>

                                <a href="{{ url_for('teams.team_details', team_id=team.id) }}"
                                   class="c-btn-modern c-btn-modern--success c-btn-modern--block"
                                   data-action="view-team"
                                   data-team-id="{{ team.id }}">
                                    <i class="ti ti-eye c-btn-modern__icon"></i>View Team
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="col-12">
                        <div class="c-card-modern">
                            <div class="c-card-modern__body c-card-modern__body--center c-card-modern__body--padded">
                                <div class="c-empty-state-modern">
                                    <div class="c-empty-state-modern__icon">
                                        <i class="ti ti-trophy"></i>
                                    </div>
                                    <p class="c-empty-state-modern__message">No Premier Division teams available.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>

        <!-- ECS FC Teams -->
        <div class="c-tab-pane-modern c-settings-tab" id="ecsfc-teams" data-tab-pane="ecsfc-teams" role="tabpanel">
            <div class="row g-3">
                {% set ecs_fc_teams = teams | selectattr("league.name", "equalto", "ECS FC") | list %}
                {% if ecs_fc_teams %}
                    {% for team in ecs_fc_teams %}
                    <div class="col-xl-4 col-md-6">
                        <div class="c-card-modern c-card-modern--clickable c-card-modern--team c-card-modern--full-height" data-team-id="{{ team.id }}">
                            <div class="c-card-modern__body">
                                <div class="c-card-modern__header-group">
                                    {{ macros.team_avatar(team, 'md', 'bg-warning me-3') }}
                                    <div class="c-card-modern__header-info">
                                        <h5 class="c-card-modern__title">{{ team.name }}</h5>
                                        <p class="c-card-modern__subtitle">
                                            <i class="ti ti-calendar-event c-icon-modern c-icon-modern--small"></i>{{ team.league.season.name }}
                                        </p>
                                    </div>
                                </div>

                                <div class="c-card-modern__meta">
                                    <div class="c-card-modern__meta-group">
                                        <div class="c-card-modern__meta-item">
                                            <i class="ti ti-users c-icon-modern"></i>{{ team.players | length }} Players
                                        </div>
                                        <div class="c-card-modern__meta-item">
                                            <i class="ti ti-shield c-icon-modern"></i>{{ team.league.name }}
                                        </div>
                                    </div>
                                </div>

                                <a href="{{ url_for('teams.team_details', team_id=team.id) }}"
                                   class="c-btn-modern c-btn-modern--warning c-btn-modern--block"
                                   data-action="view-team"
                                   data-team-id="{{ team.id }}">
                                    <i class="ti ti-eye c-btn-modern__icon"></i>View Team
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="col-12">
                        <div class="c-card-modern">
                            <div class="c-card-modern__body c-card-modern__body--center c-card-modern__body--padded">
                                <div class="c-empty-state-modern">
                                    <div class="c-empty-state-modern__icon">
                                        <i class="ti ti-shield"></i>
                                    </div>
                                    <p class="c-empty-state-modern__message">No ECS FC Division teams available.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block custom_css %}
{{ super() }}
{% if not config.get('ASSETS_PRODUCTION_MODE') %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/teams-overview.css') }}">
{% endif %}
{% endblock %}

{% block custom_js %}
{{ super() }}

{% if not config.get('ASSETS_PRODUCTION_MODE') %}
<script src="{{ url_for('static', filename='custom_js/teams-overview.js') }}"></script>

{% endif %}
{% endblock %}
