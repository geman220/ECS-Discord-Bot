{% extends "base_unauthenticated_flowbite.html" %}

{% block title %}Reset Password{% endblock %}

{% block main_content %}
<div class="min-h-screen flex items-center justify-center p-4 bg-gray-50 dark:bg-gray-900">
    <div class="w-full max-w-md">
        <!-- ECS Logo -->
        <div class="text-center mb-8">
            <img src="{{ url_for('static', filename='img/ecs_logo.png') }}"
                 alt="ECS Logo" class="w-24 h-24 mx-auto">
        </div>

        <!-- Reset Password Card -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6">
            <div class="text-center mb-6">
                <h1 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">Reset Password</h1>
                <p class="text-gray-500 dark:text-gray-400">Enter your new password below</p>
            </div>

            <form method="POST" action="{{ url_for('auth.reset_password_token', token=token) }}" class="space-y-4">
                {{ empty_form.hidden_tag() }}

                <!-- Password Field -->
                <div>
                    <label for="password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                        New Password
                    </label>
                    <div class="relative">
                        {{ form.password(class="block w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white pr-10 shadow-sm focus:border-ecs-green focus:ring-ecs-green", placeholder="Enter new password...", id="password") }}
                        <button type="button" class="absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300" onclick="togglePassword('password', this)">
                            <i class="ti ti-eye-off"></i>
                        </button>
                    </div>
                </div>

                <!-- Confirm Password Field -->
                <div>
                    <label for="password_confirm" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                        Confirm Password
                    </label>
                    <div class="relative">
                        {{ form.password_confirm(class="block w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white pr-10 shadow-sm focus:border-ecs-green focus:ring-ecs-green", placeholder="Confirm new password...", id="password_confirm") }}
                        <button type="button" class="absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300" onclick="togglePassword('password_confirm', this)">
                            <i class="ti ti-eye-off"></i>
                        </button>
                    </div>
                </div>

                <!-- Submit Button -->
                <button type="submit" class="w-full inline-flex items-center justify-center gap-2 px-4 py-3 rounded-lg bg-ecs-green text-white font-medium hover:bg-ecs-green/90 transition-colors">
                    Reset Password
                </button>
            </form>

            <!-- Footer -->
            <div class="text-center mt-6 pt-6 border-t border-gray-200 dark:border-gray-700">
                <p class="text-sm text-gray-500 dark:text-gray-400">
                    Already have an account?
                    <a href="{{ url_for('auth.login') }}" class="text-ecs-green dark:text-ecs-gold hover:underline font-medium">Login</a>
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block custom_js %}
{{ super() }}
<script>
function togglePassword(inputId, button) {
    const input = document.getElementById(inputId);
    const icon = button.querySelector('i');
    if (input.type === 'password') {
        input.type = 'text';
        icon.classList.remove('ti-eye-off');
        icon.classList.add('ti-eye');
    } else {
        input.type = 'password';
        icon.classList.remove('ti-eye');
        icon.classList.add('ti-eye-off');
    }
}
</script>
{% endblock %}
