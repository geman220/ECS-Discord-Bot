<!DOCTYPE html>
<html lang="en" class="dark-style c-auth-layout" dir="ltr" data-theme="theme-default" data-style="dark" data-assets-path="{{ url_for('static', filename='assets/') }}" data-component="auth-layout">
<head>
    <!-- Meta Tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0, viewport-fit=cover" />
    <title>{{ title }}</title>

    <!-- Fonts - Poppins (display) and Inter (body) for Athletic Warmth theme -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- ============================================
         CSS ARCHITECTURE - Clean Stack (No Sneat/Vuexy)
         ============================================
         1. Core tokens (design system variables)
         2. Bootstrap minimal (grid, flex, spacing utilities only)
         3. Component aliases (Bootstrap class â†’ BEM styling)
         4. Auth layout (BEM page-specific)
         5. Components bundle (forms, buttons, cards)
         ============================================ -->

    {% if vite_production_mode is defined and vite_production_mode() %}
    <!-- VITE PRODUCTION MODE: Bundled assets include all core tokens/variables -->
    {{ vite_asset('css/main-entry.css') }}

    {% elif vite_dev_mode is defined and vite_dev_mode() %}
    <!-- VITE DEV MODE: CSS served by Vite dev server -->
    {{ vite_asset('css/main-entry.css') }}

    {% else %}
    <!-- FLASK-ASSETS DEVELOPMENT MODE: Modular Bundles (legacy fallback) -->

    <!-- 1. Core Tokens -->
    {% assets "core_tokens" %}
        <link rel="stylesheet" href="{{ ASSET_URL }}" />
    {% endassets %}

    <!-- 2. Foundation (Bootstrap Minimal + Component Aliases) -->
    {% assets "foundation_css" %}
        <link rel="stylesheet" href="{{ ASSET_URL }}" />
    {% endassets %}

    <!-- 3. Template Styles (legacy support) -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/template-styles.css') }}" />

    <!-- 5. Components CSS Bundle (forms, buttons, cards for login/register) -->
    {% assets "components_css" %}
        <link rel="stylesheet" href="{{ ASSET_URL }}" />
    {% endassets %}

    <!-- Mobile CSS Bundle (consolidated mobile fixes) -->
    {% assets "mobile_css" %}
        <link rel="stylesheet" href="{{ ASSET_URL }}" />
    {% endassets %}
    {% endif %}

    <!-- 4. Auth Layout CSS (BEM) - Only load separately in Flask-Assets fallback mode -->
    {% if not (vite_production_mode is defined and vite_production_mode()) and not (vite_dev_mode is defined and vite_dev_mode()) %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/layout/auth-layout.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pages/authentication.css') }}" />
    {% endif %}

    <!-- Icons (deferred to not block render) -->
    <link rel="stylesheet" href="{{ url_for('static', filename='vendor/fonts/tabler-icons.css') }}" />

    <!-- Page-specific CSS (conditional loading - only in Flask-Assets fallback mode) -->
    {% if not (vite_production_mode is defined and vite_production_mode()) and not (vite_dev_mode is defined and vite_dev_mode()) %}
    {% block page_css %}
    {% endblock %}
    {% endif %}

    <!-- Config (theme settings, no Sneat helpers) -->
    <script src="{{ url_for('static', filename='js/config.js') }}"></script>

    <!-- SweetAlert2 for nicer notifications -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body class="c-auth-layout__body" data-component="auth-body">

    <!-- Authentication container -->
    <div class="c-auth-layout__container" data-component="auth-container">
        {% block main_content %}
        <!-- Page-specific content will be injected here -->
        {% endblock %}
    </div>

    <!-- Core JS - Bootstrap bundle only (no Sneat/Vuexy) -->
    <script src="{{ url_for('static', filename='vendor/libs/jquery/jquery.js') }}"></script>
    <script src="{{ url_for('static', filename='vendor/js/bootstrap.bundle.js') }}"></script>

    <!-- Sweet Alerts -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Check for SweetAlert message in session
            {% if session.get('sweet_alert') %}
                Swal.fire({
                    title: {{ session.get('sweet_alert').get('title', '') | tojson }},
                    text: {{ session.get('sweet_alert').get('text', '') | tojson }},
                    icon: {{ session.get('sweet_alert').get('icon', 'success') | tojson }},
                    confirmButtonText: "OK"
                });
                // Clear the sweet alert from session to avoid showing it again on refresh
                fetch("{{ url_for('main.clear_sweet_alert') }}", {method: 'POST'});
            {% endif %}
        });
    </script>

    <!-- Custom JS for specific pages -->
    {% block custom_js %}
    {% endblock %}
</body>
</html>
