{% extends "base.html" %}
{% import 'macros.html' as macros %}

{% block title %}Draft Predictions{% endblock %}

{% block main_content %}
<div class="container-xxl flex-grow-1 container-p-y">

    <!-- Header Section -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="c-card">
                <div class="c-card__body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h1 class="h3 mb-2 text-primary">
                                <i class="ti ti-list-numbers me-2"></i>Draft Round Predictions
                            </h1>
                            <p class="text-muted mb-0">
                                Predict which round you think players will be drafted in
                            </p>
                        </div>
                        {% if is_admin %}
                        <div>
                            <a href="{{ url_for('draft_predictions.admin_dashboard') }}" class="c-btn c-btn--outline-primary">
                                <i class="ti ti-chart-bar me-1"></i>Admin Dashboard
                            </a>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% if current_season %}
    <!-- Current Season Info -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="alert alert-info d-flex align-items-center" data-alert>
                <i class="ti ti-trophy me-2"></i>
                <div>
                    <strong>{{ current_season.name }}</strong> - Make predictions for the upcoming draft
                </div>
            </div>
        </div>
    </div>

    <!-- League Options -->
    <div class="row">
        {% if leagues %}
            {% for league in leagues %}
            <div class="col-lg-6 mb-4">
                <div class="c-card h-100">
                    <div class="c-card__body">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <div>
                                <h4 class="c-card__title mb-1">
                                    <i class="ti ti-shield me-2 text-{{ 'success' if league.type == 'Premier' else 'primary' }}"></i>
                                    {{ league.type }} League
                                </h4>
                                <p class="text-muted mb-0">{{ league.name }}</p>
                            </div>
                            <span class="badge bg-label-{{ 'success' if league.type == 'Premier' else 'primary' }}" data-badge>
                                {{ league.team_count }} Teams
                            </span>
                        </div>

                        <!-- Your Progress -->
                        <div class="mb-4">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span class="text-muted">Your Predictions</span>
                                <span class="badge bg-label-info" data-badge>{{ league.my_predictions }}</span>
                            </div>
                            {% if league.my_predictions > 0 %}
                                <div class="text-muted small">
                                    <i class="ti ti-check me-1"></i>{{ league.my_predictions }} player predictions made
                                </div>
                            {% else %}
                                <div class="text-muted small">
                                    <i class="ti ti-info-circle me-1"></i>No predictions yet - get started!
                                </div>
                            {% endif %}
                        </div>

                        <!-- Action Button -->
                        <div class="d-grid">
                            <a href="{{ url_for('draft_predictions.predict', league_type=league.type) }}"
                               class="c-btn c-btn--{{ 'success' if league.type == 'Premier' else 'primary' }}">
                                <i class="ti ti-edit me-1"></i>
                                {% if league.my_predictions > 0 %}
                                    View & Edit Predictions
                                {% else %}
                                    Make Predictions
                                {% endif %}
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <!-- No Leagues Available -->
            <div class="col-12">
                <div class="c-card">
                    <div class="c-card__body text-center py-5">
                        <div class="mb-4">
                            <i class="ti ti-trophy text-muted dp-icon-empty-lg"></i>
                        </div>
                        <h4 class="mb-3">No Leagues Available</h4>
                        <p class="text-muted mb-0">
                            No Premier or Classic leagues are set up for the current season yet.
                        </p>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>
    {% else %}
    <!-- No Current Season -->
    <div class="row">
        <div class="col-12">
            <div class="c-card">
                <div class="c-card__body text-center py-5">
                    <div class="mb-4">
                        <i class="ti ti-calendar-off text-muted dp-icon-empty-lg"></i>
                    </div>
                    <h4 class="mb-3">No Active Season</h4>
                    <p class="text-muted mb-0">
                        {{ message if message else 'There is no active season at this time.' }}
                    </p>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Help Section -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="c-card">
                <div class="c-card__body">
                    <h5 class="c-card__title">
                        <i class="ti ti-help-circle me-2"></i>How Draft Predictions Work
                    </h5>
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <div class="d-flex align-items-start">
                                <div class="badge bg-primary rounded-circle me-3 mt-1 d-flex align-items-center justify-content-center dp-step-badge">
                                    <span class="small fw-bold">1</span>
                                </div>
                                <div>
                                    <h6 class="mb-1">Choose Your League</h6>
                                    <p class="text-muted small mb-0">Select Premier or Classic league based on your team assignment.</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="d-flex align-items-start">
                                <div class="badge bg-primary rounded-circle me-3 mt-1 d-flex align-items-center justify-content-center dp-step-badge">
                                    <span class="small fw-bold">2</span>
                                </div>
                                <div>
                                    <h6 class="mb-1">Predict Draft Rounds</h6>
                                    <p class="text-muted small mb-0">For each player, predict which round you think they'll be drafted in.</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="d-flex align-items-start">
                                <div class="badge bg-primary rounded-circle me-3 mt-1 d-flex align-items-center justify-content-center dp-step-badge">
                                    <span class="small fw-bold">3</span>
                                </div>
                                <div>
                                    <h6 class="mb-1">Auto-Save</h6>
                                    <p class="text-muted small mb-0">Your predictions are saved automatically. Come back anytime to update them.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
{% endblock %}
