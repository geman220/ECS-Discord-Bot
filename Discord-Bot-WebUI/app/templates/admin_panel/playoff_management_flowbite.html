{% extends "admin_panel/base_flowbite.html" %}
{% from 'macros/flowbite.html' import card, button, badge, alert %}

{% block admin_title %}Playoff Management{% endblock %}
{% block panel_description %}Create and manage playoff tournaments{% endblock %}

{% block breadcrumb_items %}
<li>
    <div class="flex items-center">
        <i class="ti ti-chevron-right w-4 h-4 text-gray-400"></i>
        <span class="ml-1 text-sm font-medium text-gray-500 dark:text-gray-400">Playoff Management</span>
    </div>
</li>
{% endblock %}

{% block panel_content %}
<!-- Playoff Overview Stats -->
<div class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
    <div class="bg-blue-500 text-white rounded-lg shadow p-5">
        <div class="flex justify-between items-center">
            <div>
                <p class="text-3xl font-bold">{{ stats.active_playoffs or 0 }}</p>
                <p class="text-sm text-white/80">Active Playoffs</p>
            </div>
            <div class="flex items-center justify-center w-12 h-12 rounded-full bg-white/20">
                <i class="ti ti-tournament text-2xl"></i>
            </div>
        </div>
    </div>
    <div class="bg-green-500 text-white rounded-lg shadow p-5">
        <div class="flex justify-between items-center">
            <div>
                <p class="text-3xl font-bold">{{ stats.completed_playoffs or 0 }}</p>
                <p class="text-sm text-white/80">Completed Playoffs</p>
            </div>
            <div class="flex items-center justify-center w-12 h-12 rounded-full bg-white/20">
                <i class="ti ti-trophy text-2xl"></i>
            </div>
        </div>
    </div>
    <div class="bg-yellow-500 text-white rounded-lg shadow p-5">
        <div class="flex justify-between items-center">
            <div>
                <p class="text-3xl font-bold">{{ stats.upcoming_matches or 0 }}</p>
                <p class="text-sm text-white/80">Upcoming Matches</p>
            </div>
            <div class="flex items-center justify-center w-12 h-12 rounded-full bg-white/20">
                <i class="ti ti-calendar text-2xl"></i>
            </div>
        </div>
    </div>
    <div class="bg-cyan-500 text-white rounded-lg shadow p-5">
        <div class="flex justify-between items-center">
            <div>
                <p class="text-3xl font-bold">{{ stats.playoff_teams or 0 }}</p>
                <p class="text-sm text-white/80">Playoff Teams</p>
            </div>
            <div class="flex items-center justify-center w-12 h-12 rounded-full bg-white/20">
                <i class="ti ti-users text-2xl"></i>
            </div>
        </div>
    </div>
</div>

<!-- Management Actions -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
    <!-- Create & Manage Card -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
        <div class="p-5 border-b border-gray-200 dark:border-gray-700">
            <h5 class="text-lg font-semibold text-gray-900 dark:text-white">
                <i class="ti ti-plus mr-2"></i>Create & Manage
            </h5>
            <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Set up new playoffs and manage existing tournaments</p>
        </div>
        <div class="divide-y divide-gray-200 dark:divide-gray-700">
            <button type="button" class="w-full flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700 text-left" data-action="create-playoff">
                <div class="flex items-center">
                    <i class="ti ti-plus mr-3 text-green-500"></i>
                    <span class="font-medium text-gray-900 dark:text-white">Create New Playoff</span>
                </div>
                <i class="ti ti-chevron-right text-gray-400"></i>
            </button>
            <a href="#" class="flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700" data-action="view-active">
                <div class="flex items-center">
                    <i class="ti ti-tournament mr-3 text-gray-500 dark:text-gray-400"></i>
                    <span class="font-medium text-gray-900 dark:text-white">Active Playoffs</span>
                </div>
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300">{{ stats.active_playoffs or 0 }}</span>
            </a>
            <a href="#" class="flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700" data-action="bracket-gen">
                <div class="flex items-center">
                    <i class="ti ti-sitemap mr-3 text-gray-500 dark:text-gray-400"></i>
                    <span class="font-medium text-gray-900 dark:text-white">Bracket Generator</span>
                </div>
                <i class="ti ti-chevron-right text-gray-400"></i>
            </a>
            <a href="#" class="flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700" data-action="seed-teams">
                <div class="flex items-center">
                    <i class="ti ti-sort-ascending mr-3 text-gray-500 dark:text-gray-400"></i>
                    <span class="font-medium text-gray-900 dark:text-white">Seed Teams</span>
                </div>
                <i class="ti ti-chevron-right text-gray-400"></i>
            </a>
        </div>
    </div>

    <!-- Results & Reports Card -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
        <div class="p-5 border-b border-gray-200 dark:border-gray-700">
            <h5 class="text-lg font-semibold text-gray-900 dark:text-white">
                <i class="ti ti-chart-dots mr-2"></i>Results & Reports
            </h5>
            <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Track results, generate reports, and manage playoffs</p>
        </div>
        <div class="divide-y divide-gray-200 dark:divide-gray-700">
            <a href="#" class="flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700" data-action="update-results">
                <div class="flex items-center">
                    <i class="ti ti-edit mr-3 text-gray-500 dark:text-gray-400"></i>
                    <span class="font-medium text-gray-900 dark:text-white">Update Match Results</span>
                </div>
                <i class="ti ti-chevron-right text-gray-400"></i>
            </a>
            <a href="#" class="flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700" data-action="view-brackets">
                <div class="flex items-center">
                    <i class="ti ti-tournament mr-3 text-gray-500 dark:text-gray-400"></i>
                    <span class="font-medium text-gray-900 dark:text-white">View Brackets</span>
                </div>
                <i class="ti ti-chevron-right text-gray-400"></i>
            </a>
            <a href="#" class="flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700" data-action="playoff-history">
                <div class="flex items-center">
                    <i class="ti ti-history mr-3 text-gray-500 dark:text-gray-400"></i>
                    <span class="font-medium text-gray-900 dark:text-white">Playoff History</span>
                </div>
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300">{{ stats.completed_playoffs or 0 }}</span>
            </a>
            <a href="#" class="flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700" data-action="generate-reports">
                <div class="flex items-center">
                    <i class="ti ti-file-report mr-3 text-gray-500 dark:text-gray-400"></i>
                    <span class="font-medium text-gray-900 dark:text-white">Generate Reports</span>
                </div>
                <i class="ti ti-chevron-right text-gray-400"></i>
            </a>
        </div>
    </div>
</div>

<!-- Current Playoffs -->
{% if stats.active_playoffs > 0 %}
{% call card(title="Current Playoffs") %}
<div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-5">
        <div class="flex justify-between items-center mb-4">
            <h6 class="font-semibold text-gray-900 dark:text-white">Spring 2024 Championship</h6>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300">Semifinals</span>
        </div>
        <div class="grid grid-cols-3 gap-4 text-center mb-4">
            <div>
                <p class="text-xl font-bold text-gray-900 dark:text-white">8</p>
                <p class="text-xs text-gray-500 dark:text-gray-400">Teams</p>
            </div>
            <div>
                <p class="text-xl font-bold text-gray-900 dark:text-white">6</p>
                <p class="text-xs text-gray-500 dark:text-gray-400">Completed</p>
            </div>
            <div>
                <p class="text-xl font-bold text-gray-900 dark:text-white">2</p>
                <p class="text-xs text-gray-500 dark:text-gray-400">Remaining</p>
            </div>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-2 mb-4 dark:bg-gray-700">
            <div class="bg-yellow-400 h-2 rounded-full" style="width: 75%"></div>
        </div>
        <div class="flex gap-2">
            <button type="button" class="px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 dark:bg-blue-900/30 dark:text-blue-400 dark:border-blue-800" data-action="manage-tournament" data-tournament-id="spring-2024">
                <i class="ti ti-settings mr-1"></i>Manage
            </button>
            <button type="button" class="px-3 py-2 text-sm font-medium text-green-600 bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 dark:bg-green-900/30 dark:text-green-400 dark:border-green-800" data-action="view-bracket" data-tournament-id="spring-2024">
                <i class="ti ti-tournament mr-1"></i>Bracket
            </button>
        </div>
    </div>
    <div class="flex flex-col items-center justify-center text-center p-8 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg">
        <div class="flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-700 mb-4">
            <i class="ti ti-plus text-3xl text-gray-400 dark:text-gray-500"></i>
        </div>
        <p class="text-gray-500 dark:text-gray-400 mb-4">Create additional playoff tournaments</p>
        <button type="button" class="px-4 py-2 text-sm font-medium text-blue-600 bg-white border border-blue-600 rounded-lg hover:bg-blue-50 dark:bg-gray-800 dark:hover:bg-gray-700" data-action="create-playoff">
            <i class="ti ti-plus mr-1"></i>New Playoff
        </button>
    </div>
</div>
{% endcall %}
{% else %}
<div class="bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg p-5 mb-6">
    <div class="flex items-start">
        <i class="ti ti-info-circle text-xl text-blue-500 dark:text-blue-400 mr-3 mt-0.5"></i>
        <div>
            <h5 class="font-semibold text-blue-800 dark:text-blue-300 mb-1">No Active Playoffs</h5>
            <p class="text-sm text-blue-700 dark:text-blue-400 mb-3">Create your first playoff tournament to get started with bracket management.</p>
            <button type="button" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700" data-action="create-playoff">
                <i class="ti ti-plus mr-1"></i>Create First Playoff
            </button>
        </div>
    </div>
</div>
{% endif %}

<!-- Playoff Templates -->
{% call card(title="Playoff Templates") %}
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
    <!-- Single Elimination -->
    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-5 text-center">
        <div class="flex items-center justify-center w-16 h-16 mx-auto rounded-full bg-blue-100 dark:bg-blue-900/30 mb-4">
            <i class="ti ti-tournament text-3xl text-blue-500 dark:text-blue-400"></i>
        </div>
        <h6 class="font-semibold text-gray-900 dark:text-white mb-2">Single Elimination</h6>
        <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">8, 16, or 32 team bracket</p>
        <button type="button" class="px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 dark:bg-blue-900/30 dark:text-blue-400 dark:border-blue-800" data-action="use-template" data-template="single-elim">
            Use Template
        </button>
    </div>

    <!-- Double Elimination -->
    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-5 text-center">
        <div class="flex items-center justify-center w-16 h-16 mx-auto rounded-full bg-green-100 dark:bg-green-900/30 mb-4">
            <i class="ti ti-repeat text-3xl text-green-500 dark:text-green-400"></i>
        </div>
        <h6 class="font-semibold text-gray-900 dark:text-white mb-2">Double Elimination</h6>
        <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">Winners & losers brackets</p>
        <button type="button" class="px-4 py-2 text-sm font-medium text-green-600 bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 dark:bg-green-900/30 dark:text-green-400 dark:border-green-800" data-action="use-template" data-template="double-elim">
            Use Template
        </button>
    </div>

    <!-- Round Robin -->
    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-5 text-center">
        <div class="flex items-center justify-center w-16 h-16 mx-auto rounded-full bg-cyan-100 dark:bg-cyan-900/30 mb-4">
            <i class="ti ti-users text-3xl text-cyan-500 dark:text-cyan-400"></i>
        </div>
        <h6 class="font-semibold text-gray-900 dark:text-white mb-2">Round Robin</h6>
        <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">Every team plays each other</p>
        <button type="button" class="px-4 py-2 text-sm font-medium text-cyan-600 bg-cyan-50 border border-cyan-200 rounded-lg hover:bg-cyan-100 dark:bg-cyan-900/30 dark:text-cyan-400 dark:border-cyan-800" data-action="use-template" data-template="round-robin">
            Use Template
        </button>
    </div>

    <!-- Swiss System -->
    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-5 text-center">
        <div class="flex items-center justify-center w-16 h-16 mx-auto rounded-full bg-yellow-100 dark:bg-yellow-900/30 mb-4">
            <i class="ti ti-crown text-3xl text-yellow-500 dark:text-yellow-400"></i>
        </div>
        <h6 class="font-semibold text-gray-900 dark:text-white mb-2">Swiss System</h6>
        <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">Pair teams by performance</p>
        <button type="button" class="px-4 py-2 text-sm font-medium text-yellow-600 bg-yellow-50 border border-yellow-200 rounded-lg hover:bg-yellow-100 dark:bg-yellow-900/30 dark:text-yellow-400 dark:border-yellow-800" data-action="use-template" data-template="swiss">
            Use Template
        </button>
    </div>

    <!-- Group Stage -->
    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-5 text-center">
        <div class="flex items-center justify-center w-16 h-16 mx-auto rounded-full bg-red-100 dark:bg-red-900/30 mb-4">
            <i class="ti ti-layers text-3xl text-red-500 dark:text-red-400"></i>
        </div>
        <h6 class="font-semibold text-gray-900 dark:text-white mb-2">Group Stage</h6>
        <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">Groups then knockout</p>
        <button type="button" class="px-4 py-2 text-sm font-medium text-red-600 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 dark:bg-red-900/30 dark:text-red-400 dark:border-red-800" data-action="use-template" data-template="group-stage">
            Use Template
        </button>
    </div>

    <!-- Custom Format -->
    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-5 text-center">
        <div class="flex items-center justify-center w-16 h-16 mx-auto rounded-full bg-gray-100 dark:bg-gray-700 mb-4">
            <i class="ti ti-settings text-3xl text-gray-500 dark:text-gray-400"></i>
        </div>
        <h6 class="font-semibold text-gray-900 dark:text-white mb-2">Custom Format</h6>
        <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">Design your own format</p>
        <button type="button" class="px-4 py-2 text-sm font-medium text-gray-600 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600" data-action="use-template" data-template="custom">
            Create Custom
        </button>
    </div>
</div>
{% endcall %}
{% endblock %}
