{% extends "admin_panel/base.html" %}
{% import 'macros.html' as macros %}

{% block title %}Mobile Features - Admin Panel{% endblock %}

{% block breadcrumb_items %}
<li class="breadcrumb-item active">Mobile Features</li>
{% endblock %}

{% block panel_content %}
<div class="c-mobile-hub" data-component="mobile-hub">
    <!-- Mobile Features Overview -->
    <div class="c-mobile-stats" data-component="stats-grid">
        <div class="c-mobile-stats__grid">
            <div class="c-stat-card c-stat-card--primary" data-stat-card data-stat-type="installs">
                <div class="c-stat-card__content">
                    <div class="c-stat-card__value">{{ stats.total_app_installs or 0 }}</div>
                    <div class="c-stat-card__label">App Installs</div>
                </div>
                <div class="c-stat-card__icon">
                    <i class="ti ti-download"></i>
                </div>
            </div>
            <div class="c-stat-card c-stat-card--success" data-stat-card data-stat-type="users">
                <div class="c-stat-card__content">
                    <div class="c-stat-card__value">{{ stats.mobile_users or 0 }}</div>
                    <div class="c-stat-card__label">Mobile Users</div>
                </div>
                <div class="c-stat-card__icon">
                    <i class="ti ti-device-mobile"></i>
                </div>
            </div>
            <div class="c-stat-card c-stat-card--warning" data-stat-card data-stat-type="subscriptions">
                <div class="c-stat-card__content">
                    <div class="c-stat-card__value">{{ stats.push_subscriptions or 0 }}</div>
                    <div class="c-stat-card__label">Push Subscriptions</div>
                </div>
                <div class="c-stat-card__icon">
                    <i class="ti ti-bell"></i>
                </div>
            </div>
            <div class="c-stat-card c-stat-card--info" data-stat-card data-stat-type="downloads">
                <div class="c-stat-card__content">
                    <div class="c-stat-card__value">{{ stats.app_downloads or 0 }}</div>
                    <div class="c-stat-card__label">App Downloads</div>
                </div>
                <div class="c-stat-card__icon">
                    <i class="ti ti-download"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile User & App Management -->
    <div class="c-mobile-sections" data-component="sections-grid">
        <div class="c-mobile-sections__grid">
            <!-- Mobile User Management -->
            <div class="c-card" data-card data-section="users">
                <div class="c-card__header">
                    <div class="c-card__title">
                        <i class="ti ti-users c-card__title-icon c-card__title-icon--primary"></i>
                        <span>Mobile User Management</span>
                    </div>
                </div>
                <div class="c-card__body">
                    <p class="c-card__description">Manage users with mobile app access and their roles</p>
                    <nav class="c-link-list" aria-label="Mobile user management">
                        <a href="{{ url_for('admin_panel.mobile_user_management') }}"
                           class="c-link-list__item"
                           data-action="navigate-link"
                           data-target="manage-mobile-users">
                            <div class="c-link-list__content">
                                <div class="c-link-list__icon">
                                    <i class="ti ti-user-cog"></i>
                                </div>
                                <div class="c-link-list__text">
                                    <div class="c-link-list__title">Manage Mobile Users</div>
                                </div>
                            </div>
                            <div class="c-link-list__meta">
                                <span class="c-badge c-badge--primary" data-badge data-count="{{ stats.mobile_users or 0 }}">{{ stats.mobile_users or 0 }}</span>
                                <i class="ti ti-chevron-right c-link-list__arrow"></i>
                            </div>
                        </a>
                        <a href="{{ url_for('admin_panel.user_management') }}"
                           class="c-link-list__item"
                           data-action="navigate-link"
                           data-target="all-users">
                            <div class="c-link-list__content">
                                <div class="c-link-list__icon">
                                    <i class="ti ti-users-group"></i>
                                </div>
                                <div class="c-link-list__text">
                                    <div class="c-link-list__title">All User Management</div>
                                </div>
                            </div>
                            <div class="c-link-list__meta">
                                <i class="ti ti-chevron-right c-link-list__arrow"></i>
                            </div>
                        </a>
                        <a href="{{ url_for('admin_panel.mobile_users') }}"
                           class="c-link-list__item"
                           data-action="navigate-link"
                           data-target="view-mobile-users">
                            <div class="c-link-list__content">
                                <div class="c-link-list__icon">
                                    <i class="ti ti-device-mobile"></i>
                                </div>
                                <div class="c-link-list__text">
                                    <div class="c-link-list__title">View Mobile Users</div>
                                </div>
                            </div>
                            <div class="c-link-list__meta">
                                <span class="c-badge c-badge--success" data-badge data-count="{{ stats.active_mobile_users or 0 }}">{{ stats.active_mobile_users or 0 }}</span>
                                <i class="ti ti-chevron-right c-link-list__arrow"></i>
                            </div>
                        </a>
                    </nav>
                </div>
            </div>

            <!-- Mobile App Settings -->
            <div class="c-card" data-card data-section="app-settings">
                <div class="c-card__header">
                    <div class="c-card__title">
                        <i class="ti ti-device-mobile c-card__title-icon c-card__title-icon--success"></i>
                        <span>Mobile App Settings</span>
                    </div>
                </div>
                <div class="c-card__body">
                    <p class="c-card__description">Configure mobile app features and functionality</p>
                    <nav class="c-link-list" aria-label="Mobile app settings">
                        <a href="{{ url_for('admin_panel.mobile_config') }}"
                           class="c-link-list__item"
                           data-action="navigate-link"
                           data-target="app-configuration">
                            <div class="c-link-list__content">
                                <div class="c-link-list__icon">
                                    <i class="ti ti-settings-cog"></i>
                                </div>
                                <div class="c-link-list__text">
                                    <div class="c-link-list__title">App Configuration</div>
                                </div>
                            </div>
                            <div class="c-link-list__meta">
                                <i class="ti ti-chevron-right c-link-list__arrow"></i>
                            </div>
                        </a>
                        <a href="{{ url_for('admin_panel.mobile_app_distribution') }}"
                           class="c-link-list__item"
                           data-action="navigate-link"
                           data-target="app-distribution">
                            <div class="c-link-list__content">
                                <div class="c-link-list__icon">
                                    <i class="ti ti-app-window"></i>
                                </div>
                                <div class="c-link-list__text">
                                    <div class="c-link-list__title">App Distribution</div>
                                </div>
                            </div>
                            <div class="c-link-list__meta">
                                <i class="ti ti-chevron-right c-link-list__arrow"></i>
                            </div>
                        </a>
                        <a href="{{ url_for('admin_panel.mobile_features_toggle') }}"
                           class="c-link-list__item"
                           data-action="navigate-link"
                           data-target="feature-toggles">
                            <div class="c-link-list__content">
                                <div class="c-link-list__icon">
                                    <i class="ti ti-toggle-left"></i>
                                </div>
                                <div class="c-link-list__text">
                                    <div class="c-link-list__title">Feature Toggles</div>
                                </div>
                            </div>
                            <div class="c-link-list__meta">
                                <i class="ti ti-chevron-right c-link-list__arrow"></i>
                            </div>
                        </a>
                    </nav>
                </div>
            </div>
        </div>
    </div>

    <!-- Push Notifications & Analytics -->
    <div class="c-mobile-sections" data-component="sections-grid">
        <div class="c-mobile-sections__grid">
            <!-- Push Notification Management -->
            <div class="c-card" data-card data-section="push">
                <div class="c-card__header">
                    <div class="c-card__title">
                        <i class="ti ti-bell c-card__title-icon c-card__title-icon--warning"></i>
                        <span>Push Notifications</span>
                    </div>
                </div>
                <div class="c-card__body">
                    <p class="c-card__description">Manage mobile push notification campaigns</p>
                    <nav class="c-link-list" aria-label="Push notification management">
                        <a href="{{ url_for('admin_panel.push_notifications') }}"
                           class="c-link-list__item"
                           data-action="navigate-link"
                           data-target="send-notification">
                            <div class="c-link-list__content">
                                <div class="c-link-list__icon">
                                    <i class="ti ti-send"></i>
                                </div>
                                <div class="c-link-list__text">
                                    <div class="c-link-list__title">Send Notification</div>
                                </div>
                            </div>
                            <div class="c-link-list__meta">
                                <i class="ti ti-chevron-right c-link-list__arrow"></i>
                            </div>
                        </a>
                        <a href="{{ url_for('admin_panel.notification_groups_list') }}"
                           class="c-link-list__item"
                           data-action="navigate-link"
                           data-target="notification-groups">
                            <div class="c-link-list__content">
                                <div class="c-link-list__icon">
                                    <i class="ti ti-users-group"></i>
                                </div>
                                <div class="c-link-list__text">
                                    <div class="c-link-list__title">Notification Groups</div>
                                </div>
                            </div>
                            <div class="c-link-list__meta">
                                <i class="ti ti-chevron-right c-link-list__arrow"></i>
                            </div>
                        </a>
                        <a href="{{ url_for('admin_panel.campaigns_list') }}"
                           class="c-link-list__item"
                           data-action="navigate-link"
                           data-target="push-campaigns">
                            <div class="c-link-list__content">
                                <div class="c-link-list__icon">
                                    <i class="ti ti-broadcast"></i>
                                </div>
                                <div class="c-link-list__text">
                                    <div class="c-link-list__title">Push Campaigns</div>
                                </div>
                            </div>
                            <div class="c-link-list__meta">
                                <i class="ti ti-chevron-right c-link-list__arrow"></i>
                            </div>
                        </a>
                        <a href="{{ url_for('admin_panel.push_subscriptions') }}"
                           class="c-link-list__item"
                           data-action="navigate-link"
                           data-target="subscriptions">
                            <div class="c-link-list__content">
                                <div class="c-link-list__icon">
                                    <i class="ti ti-users"></i>
                                </div>
                                <div class="c-link-list__text">
                                    <div class="c-link-list__title">Subscriptions</div>
                                </div>
                            </div>
                            <div class="c-link-list__meta">
                                <span class="c-badge c-badge--warning" data-badge data-count="{{ stats.push_subscriptions or 0 }}">{{ stats.push_subscriptions or 0 }}</span>
                                <i class="ti ti-chevron-right c-link-list__arrow"></i>
                            </div>
                        </a>
                        <a href="{{ url_for('admin_panel.push_history') }}"
                           class="c-link-list__item"
                           data-action="navigate-link"
                           data-target="notification-history">
                            <div class="c-link-list__content">
                                <div class="c-link-list__icon">
                                    <i class="ti ti-history"></i>
                                </div>
                                <div class="c-link-list__text">
                                    <div class="c-link-list__title">Notification History</div>
                                </div>
                            </div>
                            <div class="c-link-list__meta">
                                <i class="ti ti-chevron-right c-link-list__arrow"></i>
                            </div>
                        </a>
                    </nav>
                </div>
            </div>

            <!-- Mobile Analytics -->
            <div class="c-card" data-card data-section="analytics">
                <div class="c-card__header">
                    <div class="c-card__title">
                        <i class="ti ti-chart-line c-card__title-icon c-card__title-icon--info"></i>
                        <span>Mobile Analytics</span>
                    </div>
                </div>
                <div class="c-card__body">
                    <p class="c-card__description">Track mobile app performance and user engagement</p>
                    <nav class="c-link-list" aria-label="Mobile analytics">
                        <a href="{{ url_for('admin_panel.mobile_analytics') }}"
                           class="c-link-list__item"
                           data-action="navigate-link"
                           data-target="usage-analytics">
                            <div class="c-link-list__content">
                                <div class="c-link-list__icon">
                                    <i class="ti ti-chart-dots"></i>
                                </div>
                                <div class="c-link-list__text">
                                    <div class="c-link-list__title">Usage Analytics</div>
                                </div>
                            </div>
                            <div class="c-link-list__meta">
                                <i class="ti ti-chevron-right c-link-list__arrow"></i>
                            </div>
                        </a>
                        <a href="{{ url_for('admin_panel.mobile_app_analytics') }}"
                           class="c-link-list__item"
                           data-action="navigate-link"
                           data-target="app-analytics">
                            <div class="c-link-list__content">
                                <div class="c-link-list__icon">
                                    <i class="ti ti-chart-bar"></i>
                                </div>
                                <div class="c-link-list__text">
                                    <div class="c-link-list__title">App Analytics</div>
                                </div>
                            </div>
                            <div class="c-link-list__meta">
                                <i class="ti ti-chevron-right c-link-list__arrow"></i>
                            </div>
                        </a>
                        <div class="c-link-list__item" data-list-item data-item-type="status">
                            <div class="c-link-list__content">
                                <div class="c-link-list__icon">
                                    <i class="ti ti-download"></i>
                                </div>
                                <div class="c-link-list__text">
                                    <div class="c-link-list__title">App Downloads</div>
                                </div>
                            </div>
                            <div class="c-link-list__meta">
                                <span class="c-badge c-badge--info" data-badge data-count="{{ stats.app_downloads or 0 }}">{{ stats.app_downloads or 0 }}</span>
                            </div>
                        </div>
                        <div class="c-link-list__item" data-list-item data-item-type="status">
                            <div class="c-link-list__content">
                                <div class="c-link-list__icon">
                                    <i class="ti ti-users"></i>
                                </div>
                                <div class="c-link-list__text">
                                    <div class="c-link-list__title">Active Mobile Users</div>
                                </div>
                            </div>
                            <div class="c-link-list__meta">
                                <span class="c-badge c-badge--success" data-badge data-count="{{ stats.active_mobile_users or 0 }}">{{ stats.active_mobile_users or 0 }}</span>
                            </div>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Status & Configuration -->
    <div class="c-mobile-status" data-component="status-panel">
        <div class="c-card" data-card data-section="status">
            <div class="c-card__header">
                <div class="c-card__title">
                    <i class="ti ti-device-mobile c-card__title-icon c-card__title-icon--primary"></i>
                    <span>Mobile Platform Status</span>
                </div>
            </div>
            <div class="c-card__body">
                <div class="c-mobile-status__grid">
                    <div class="c-mobile-status__item" data-status-item data-type="service">
                        <div class="c-mobile-status__value c-mobile-status__value--{% if stats.mobile_service_status == 'active' %}success{% else %}danger{% endif %}">
                            {% if stats.mobile_service_status == 'active' %}Online{% else %}Offline{% endif %}
                        </div>
                        <div class="c-mobile-status__label">Mobile Service</div>
                    </div>
                    <div class="c-mobile-status__item" data-status-item data-type="push">
                        <div class="c-mobile-status__value c-mobile-status__value--{% if stats.push_service_status == 'active' %}success{% else %}danger{% endif %}">
                            {% if stats.push_service_status == 'active' %}Active{% else %}Inactive{% endif %}
                        </div>
                        <div class="c-mobile-status__label">Push Service</div>
                    </div>
                    <div class="c-mobile-status__item" data-status-item data-type="version">
                        <div class="c-mobile-status__value c-mobile-status__value--info">{{ stats.mobile_app_version or 'v1.0.0' }}</div>
                        <div class="c-mobile-status__label">App Version</div>
                    </div>
                    <div class="c-mobile-status__item" data-status-item data-type="updated">
                        <div class="c-mobile-status__value c-mobile-status__value--primary">{{ stats.last_updated or 'Recently' }}</div>
                        <div class="c-mobile-status__label">Last Updated</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Information Alert -->
    <div class="c-mobile-info" data-component="info-alert">
        <div class="c-alert c-alert--info">
            <div class="c-alert__icon">
                <i class="ti ti-info-circle"></i>
            </div>
            <div class="c-alert__content">
                <h6 class="c-alert__title">Mobile App Status Information</h6>
                <p class="c-alert__text">
                    <strong>Mobile Service Status</strong> reflects whether the mobile app is configured and enabled in Admin Settings.
                    <strong>Push Service Status</strong> shows if push notifications are enabled.
                </p>
            </div>
        </div>
    </div>

    <!-- Mobile API Documentation -->
    <div class="c-mobile-api" data-component="api-docs">
        <div class="c-card" data-card data-section="api">
            <div class="c-card__header">
                <div class="c-card__title">
                    <i class="ti ti-api c-card__title-icon c-card__title-icon--success"></i>
                    <span>Mobile API Documentation</span>
                </div>
            </div>
            <div class="c-card__body">
                <p class="c-card__description">
                    The following API endpoints are available for mobile app integration. Share this with the mobile development team.
                </p>
                <div class="c-table-wrapper" data-table-wrapper>
                    <table class="c-c-table c-table--hoverable" data-table data-mobile-table data-table-type="api">
                        <thead class="c-table__head">
                            <tr class="c-table__row">
                                <th class="c-table__header">Endpoint</th>
                                <th class="c-table__header">Method</th>
                                <th class="c-table__header">Description</th>
                            </tr>
                        </thead>
                        <tbody class="c-table__body">
                            <tr class="c-table__row">
                                <td class="c-table__cell"><code>/api/mobile/auth/login</code></td>
                                <td class="c-table__cell"><span class="c-badge c-badge--success" data-badge>POST</span></td>
                                <td class="c-table__cell">User authentication</td>
                            </tr>
                            <tr class="c-table__row">
                                <td class="c-table__cell"><code>/api/mobile/user/profile</code></td>
                                <td class="c-table__cell"><span class="c-badge c-badge--primary" data-badge>GET</span></td>
                                <td class="c-table__cell">Get user profile data</td>
                            </tr>
                            <tr class="c-table__row">
                                <td class="c-table__cell"><code>/api/mobile/matches</code></td>
                                <td class="c-table__cell"><span class="c-badge c-badge--primary" data-badge>GET</span></td>
                                <td class="c-table__cell">Get matches for user's team</td>
                            </tr>
                            <tr class="c-table__row">
                                <td class="c-table__cell"><code>/api/mobile/push/register</code></td>
                                <td class="c-table__cell"><span class="c-badge c-badge--success" data-badge>POST</span></td>
                                <td class="c-table__cell">Register device for push notifications</td>
                            </tr>
                            <tr class="c-table__row">
                                <td class="c-table__cell"><code>/api/mobile/notifications</code></td>
                                <td class="c-table__cell"><span class="c-badge c-badge--primary" data-badge>GET</span></td>
                                <td class="c-table__cell">Get user notifications</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="c-mobile-api__note">
                    <i class="ti ti-info-circle"></i>
                    Full API documentation available at <code>/api/docs</code> (if enabled) or contact tech support for Swagger/OpenAPI spec.
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block custom_css %}
{{ super() }}
{% if not config.get('ASSETS_PRODUCTION_MODE') and (vite_production_mode is not defined or not vite_production_mode()) %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/admin-panel/mobile-features.css') }}">
{% endif %}
{% endblock %}
