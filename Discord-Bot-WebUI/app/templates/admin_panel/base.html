{% extends "base.html" %}

{% block main_content %}
<!-- Note: Skip link and main landmark are inherited from base.html -->
<div class="container-xxl flex-grow-1 container-p-y" data-component="admin-panel-base">
    <!-- Admin Panel Header -->
    <div class="c-admin-panel-base__header-wrapper">
        <div class="c-admin-panel-base__header-container">
            <div class="c-admin-panel-base__header" data-component="admin-header">
                <div class="c-admin-panel-base__header-content">
                    <div class="c-admin-panel-base__header-text">
                        <h1 class="c-admin-panel-base__title">
                            <i class="ti ti-settings c-admin-panel-base__title-icon"></i>Admin Panel
                        </h1>
                        <p class="c-admin-panel-base__description">
                            {% block panel_description %}Centralized administrative control center for ECS FC{% endblock %}
                        </p>
                    </div>
                    <div class="c-admin-panel-base__header-meta">
                        <div class="c-admin-panel-base__role-badge">
                            <i class="ti ti-shield-check c-admin-panel-base__role-icon"></i>
                            <span class="c-admin-panel-base__role-text c-admin-panel-base__role-text--desktop">
                                {% if 'Global Admin' in user_roles %}Global Admin{% else %}Pub League Admin{% endif %}
                            </span>
                            <span class="c-admin-panel-base__role-text c-admin-panel-base__role-text--mobile">Admin</span>
                        </div>
                        <div class="c-admin-panel-base__user-info">
                            <span class="c-admin-panel-base__user-label c-admin-panel-base__user-label--desktop">Logged in as: </span>
                            <span class="c-admin-panel-base__user-name c-admin-panel-base__user-name--mobile">
                                {{ (safe_current_user.name or safe_current_user.username)[:15] }}{% if (safe_current_user.name or safe_current_user.username)|length > 15 %}...{% endif %}
                            </span>
                            <span class="c-admin-panel-base__user-name c-admin-panel-base__user-name--desktop">
                                {{ safe_current_user.name or safe_current_user.username }}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Navigation Toggle -->
    <div class="c-admin-panel-base__mobile-nav-toggle">
        <button class="c-btn c-btn--primary c-btn--block"
                type="button"
                data-action="toggle-mobile-nav"
                aria-expanded="true"
                aria-controls="adminNavigation">
            <i class="ti ti-menu-2 c-admin-panel-base__mobile-nav-icon"></i>
            <span class="c-admin-panel-base__mobile-nav-text">Admin Navigation</span>
        </button>
    </div>

    <!-- Navigation Tabs - NO Bootstrap collapse, pure CSS visibility -->
    <div class="c-admin-panel-base__navigation" id="adminNavigation" data-nav-container>
        <div class="c-admin-panel-base__navigation-container">
            {% include 'admin_panel/_navigation.html' %}
        </div>
    </div>

    <!-- Breadcrumb Navigation -->
    <nav class="c-admin-panel-base__breadcrumb"
         aria-label="breadcrumb"
         data-component="breadcrumb">
        <ol class="c-breadcrumb">
            <li class="c-breadcrumb__item">
                <a href="{{ url_for('admin_panel.dashboard') }}"
                   class="c-breadcrumb__link"
                   data-action="navigate">Admin Panel</a>
            </li>
            {% block breadcrumb_items %}{% endblock %}
        </ol>
    </nav>

    <!-- Page Content -->
    <div class="c-admin-panel-base__content" data-content>
        {% block panel_content %}{% endblock %}
    </div>

    <!-- Network Status Indicator -->
    <div class="c-admin-panel-base__network-status c-admin-panel-base__network-status--online"
         data-component="network-status"
         data-status="online"
         title="Online"
         role="status"
         aria-live="polite"></div>

    <!-- Toast Container for Mobile Notifications -->
    <div class="c-admin-panel-base__toast-container"
         data-component="toast-container"
         role="region"
         aria-label="Notifications"></div>
</div>
{% endblock %}

{% block custom_css %}
{{ super() }}
<!-- Admin Panel Base Layout - BEM Classes -->
<!-- Dropdowns: Handled by components/dropdowns.css (loaded globally) -->
{% if not config.get('ASSETS_PRODUCTION_MODE') and (vite_production_mode is not defined or not vite_production_mode()) %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/admin-panel/base.css') }}?v={{ config.get('STATIC_VERSION', '3') }}" />
<link rel="stylesheet" href="{{ url_for('static', filename='css/components/admin-navigation.css') }}?v={{ config.get('STATIC_VERSION', '3') }}" />
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/admin-panel/dashboard.css') }}?v={{ config.get('STATIC_VERSION', '3') }}" />
{% endif %}
{% endblock %}

{% block custom_js %}
{{ super() }}
{% if not config.get('ASSETS_PRODUCTION_MODE') and (vite_production_mode is not defined or not vite_production_mode()) %}
<!-- Admin Utilities - Apply data attributes dynamically -->
<script src="{{ url_for('static', filename='js/admin-utilities-init.js') }}?v=3"></script>
<!-- Admin Navigation Controller - Event delegation for navigation -->
<script src="{{ url_for('static', filename='js/admin-navigation.js') }}?v=3"></script>
<!-- Admin Panel Base - Core functionality -->
<script src="{{ url_for('static', filename='js/admin-panel-base.js') }}?v=3" defer></script>
{% endif %}
{% endblock %}