{% extends "admin_panel/base.html" %}

{% block title %}League Management - Admin Panel{% endblock %}

{% block breadcrumb_items %}
<li class="breadcrumb-item">
    <a href="{{ url_for('admin_panel.match_operations') }}">Match Operations</a>
</li>
<li class="breadcrumb-item active">League Management</li>
{% endblock %}

{% block panel_content %}

<!-- Statistics Cards -->
<div class="c-stats-grid" data-component="stats-grid">
    <div class="c-stat-card c-stat-card--primary" data-stat-card data-stat-type="total">
        <div class="c-stat-card__content">
            <div class="c-stat-card__body">
                <h5 class="c-stat-card__value">{{ stats.total_leagues or 0 }}</h5>
                <p class="c-stat-card__label">Total Leagues</p>
            </div>
            <div class="c-stat-card__icon">
                <i class="ti ti-flag"></i>
            </div>
        </div>
    </div>

    <div class="c-stat-card c-stat-card--success" data-stat-card data-stat-type="active">
        <div class="c-stat-card__content">
            <div class="c-stat-card__body">
                <h5 class="c-stat-card__value">{{ stats.active_leagues or 0 }}</h5>
                <p class="c-stat-card__label">Active Leagues</p>
            </div>
            <div class="c-stat-card__icon">
                <i class="ti ti-flag-check"></i>
            </div>
        </div>
    </div>

    <div class="c-stat-card c-stat-card--warning" data-stat-card data-stat-type="with-teams">
        <div class="c-stat-card__content">
            <div class="c-stat-card__body">
                <h5 class="c-stat-card__value">{{ stats.leagues_with_teams or 0 }}</h5>
                <p class="c-stat-card__label">With Teams</p>
            </div>
            <div class="c-stat-card__icon">
                <i class="ti ti-users"></i>
            </div>
        </div>
    </div>

    <div class="c-stat-card c-stat-card--info" data-stat-card data-stat-type="with-matches">
        <div class="c-stat-card__content">
            <div class="c-stat-card__body">
                <h5 class="c-stat-card__value">{{ stats.leagues_with_matches or 0 }}</h5>
                <p class="c-stat-card__label">With Matches</p>
            </div>
            <div class="c-stat-card__icon">
                <i class="ti ti-calendar"></i>
            </div>
        </div>
    </div>
</div>

<!-- Leagues Table -->
<div class="c-panel-section" data-component="panel-section">
    <div class="c-card" data-card>
        <div class="c-card__header c-card__header--action">
            <h5 class="c-card__title">
                <i class="ti ti-flag"></i>Leagues
            </h5>
            <button class="c-btn c-btn--primary c-btn--sm" data-action="create-league">
                <i class="ti ti-plus"></i>Create League
            </button>
        </div>
        <div class="c-card__body">
            {% if leagues %}
            <div class="c-c-table-wrapper" data-table-container>
                <table class="c-c-table" data-table data-mobile-table data-table-type="leagues">
                    <thead class="c-table__head">
                        <tr class="c-table__row">
                            <th class="c-table__header" scope="col">League Name</th>
                            <th class="c-table__header" scope="col">Season</th>
                            <th class="c-table__header" scope="col">Teams</th>
                            <th class="c-table__header" scope="col">Matches</th>
                            <th class="c-table__header" scope="col">Status</th>
                            <th class="c-table__header" scope="col">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="c-table__body">
                        {% for league in leagues %}
                        <tr class="c-table__row" data-league-id="{{ league.id }}">
                            <td class="c-table__cell" data-label="League Name">
                                <strong>{{ league.name }}</strong>
                            </td>
                            <td class="c-table__cell" data-label="Season">
                                <span class="c-text-muted">{{ league.season.name if league.season else 'No Season' }}</span>
                            </td>
                            <td class="c-table__cell" data-label="Teams">
                                <span class="c-badge c-badge--primary" data-badge data-badge-type="count">{{ league.team_count or 0 }}</span>
                            </td>
                            <td class="c-table__cell" data-label="Matches">
                                <span class="c-badge c-badge--info" data-badge data-badge-type="count">{{ league.match_count or 0 }}</span>
                            </td>
                            <td class="c-table__cell" data-label="Status">
                                <span class="c-badge c-badge--success" data-badge data-status="active">{{ league.status or 'Active' }}</span>
                            </td>
                            <td class="c-table__cell" data-label="Actions">
                                <div class="c-btn-group" data-btn-group>
                                    <button class="c-btn c-btn--icon c-btn--outline-info" data-action="view-league" data-league-id="{{ league.id }}" aria-label="View league">
                                        <i class="ti ti-eye"></i>
                                    </button>
                                    <button class="c-btn c-btn--icon c-btn--outline-warning" data-action="edit-league" data-league-id="{{ league.id }}" aria-label="Edit league">
                                        <i class="ti ti-edit"></i>
                                    </button>
                                    <button class="c-btn c-btn--icon c-btn--outline-success" data-action="toggle-league" data-league-id="{{ league.id }}" aria-label="Toggle league status">
                                        <i class="ti ti-toggle-left"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div class="c-empty-state" data-component="empty-state" data-empty-type="leagues">
                <i class="ti ti-flag-off c-empty-state__icon"></i>
                <h5 class="c-empty-state__title">No Leagues Found</h5>
                <p class="c-empty-state__text">Create your first league to get started.</p>
                <button class="c-btn c-btn--primary" data-action="create-league">
                    <i class="ti ti-plus"></i>Create League
                </button>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Info Alert -->
<div class="c-panel-section" data-component="panel-section">
    <div class="c-alert c-alert--info" data-alert data-alert-type="info">
        <i class="ti ti-info-circle c-alert__icon"></i>
        <div class="c-alert__content">
            <strong>League Management:</strong>
            Manage all leagues in your system. Create new leagues, edit existing ones, and manage team assignments.
        </div>
    </div>
</div>

{% endblock %}

{% block custom_css %}
{{ super() }}
{% if not config.get('ASSETS_PRODUCTION_MODE') and (vite_production_mode is not defined or not vite_production_mode()) %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/match-operations/seasons.css') }}">
{% endif %}
{% endblock %}

{% block custom_js %}
{{ super() }}
{% if not config.get('ASSETS_PRODUCTION_MODE') and (vite_production_mode is not defined or not vite_production_mode()) %}
<script src="{{ url_for('static', filename='js/match-operations/manage-leagues.js') }}"></script>
{% endif %}
{% endblock %}
