{% extends "admin_panel/base.html" %}

{% block title %}Live Matches - Admin Panel{% endblock %}

{% block breadcrumb_items %}
<li class="breadcrumb-item">
    <a href="{{ url_for('admin_panel.match_operations') }}">Match Operations</a>
</li>
<li class="breadcrumb-item active">Live Matches</li>
{% endblock %}

{% block custom_css %}
{{ super() }}
{% if not config.get('ASSETS_PRODUCTION_MODE') and (vite_production_mode is not defined or not vite_production_mode()) %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/match-operations/seasons.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/match-operations/live-matches.css') }}">
{% endif %}
{% endblock %}

{% block panel_content %}

<!-- Statistics Cards -->
<div class="c-stats-grid" data-component="stats-grid">
    <div class="c-stat-card c-stat-card--primary">
        <div class="c-stat-card__content">
            <div class="c-stat-card__body">
                <h5 class="c-stat-card__value">{{ stats.total_today or 0 }}</h5>
                <p class="c-stat-card__label">Total Today</p>
            </div>
            <i class="ti ti-calendar c-stat-card__icon"></i>
        </div>
    </div>
    <div class="c-stat-card c-stat-card--success">
        <div class="c-stat-card__content">
            <div class="c-stat-card__body">
                <h5 class="c-stat-card__value">{{ stats.in_progress or 0 }}</h5>
                <p class="c-stat-card__label">In Progress</p>
            </div>
            <i class="ti ti-broadcast c-stat-card__icon"></i>
        </div>
    </div>
    <div class="c-stat-card c-stat-card--warning">
        <div class="c-stat-card__content">
            <div class="c-stat-card__body">
                <h5 class="c-stat-card__value">{{ stats.upcoming_today or 0 }}</h5>
                <p class="c-stat-card__label">Upcoming Today</p>
            </div>
            <i class="ti ti-clock c-stat-card__icon"></i>
        </div>
    </div>
    <div class="c-stat-card c-stat-card--info">
        <div class="c-stat-card__content">
            <div class="c-stat-card__body">
                <h5 class="c-stat-card__value">{{ stats.completed_today or 0 }}</h5>
                <p class="c-stat-card__label">Completed Today</p>
            </div>
            <i class="ti ti-check c-stat-card__icon"></i>
        </div>
    </div>
</div>

<!-- Live Matches Content -->
<div class="c-match-columns" data-component="match-columns">
    <!-- Matches In Progress -->
    <div class="c-match-column" data-column-type="in-progress">
        <div class="c-card">
            <div class="c-card__header">
                <h5 class="c-card__title">
                    <i class="ti ti-broadcast"></i>
                    In Progress
                </h5>
            </div>
            <div class="c-card__body">
                {% if in_progress %}
                    {% for match in in_progress %}
                    <div class="c-match-item" data-component="match-item" data-match-id="{{ match.id }}">
                        <div class="c-match-item__teams">
                            <h6 class="c-match-item__matchup">
                                {{ match.home_team.name if match.home_team else 'TBD' }} vs {{ match.away_team.name if match.away_team else 'TBD' }}
                            </h6>
                            <div class="c-match-item__time">
                                {% if match.time %}{{ match.time.strftime('%H:%M') }}{% else %}TBD{% endif %}
                            </div>
                        </div>
                        <div class="c-match-item__status">
                            {% if match.home_team_score is not none and match.away_team_score is not none %}
                                <span class="c-badge c-badge--success">{{ match.home_team_score }} - {{ match.away_team_score }}</span>
                            {% else %}
                                <span class="c-badge c-badge--warning">Live</span>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="c-empty-state c-empty-state--compact" data-component="empty-state">
                        <i class="ti ti-broadcast c-empty-state__icon"></i>
                        <p class="c-empty-state__text">No matches in progress</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Upcoming Today -->
    <div class="c-match-column" data-column-type="upcoming">
        <div class="c-card">
            <div class="c-card__header">
                <h5 class="c-card__title">
                    <i class="ti ti-clock"></i>
                    Upcoming Today
                </h5>
            </div>
            <div class="c-card__body">
                {% if upcoming_today %}
                    {% for match in upcoming_today %}
                    <div class="c-match-item" data-component="match-item" data-match-id="{{ match.id }}">
                        <div class="c-match-item__teams">
                            <h6 class="c-match-item__matchup">
                                {{ match.home_team.name if match.home_team else 'TBD' }} vs {{ match.away_team.name if match.away_team else 'TBD' }}
                            </h6>
                            <div class="c-match-item__time">
                                {% if match.time %}{{ match.time.strftime('%H:%M') }}{% else %}TBD{% endif %}
                            </div>
                        </div>
                        <div class="c-match-item__status">
                            <span class="c-badge c-badge--info">Scheduled</span>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="c-empty-state c-empty-state--compact" data-component="empty-state">
                        <i class="ti ti-clock c-empty-state__icon"></i>
                        <p class="c-empty-state__text">No upcoming matches today</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Completed Today -->
    <div class="c-match-column" data-column-type="completed">
        <div class="c-card">
            <div class="c-card__header">
                <h5 class="c-card__title">
                    <i class="ti ti-check"></i>
                    Completed Today
                </h5>
            </div>
            <div class="c-card__body">
                {% if completed_today %}
                    {% for match in completed_today %}
                    <div class="c-match-item" data-component="match-item" data-match-id="{{ match.id }}">
                        <div class="c-match-item__teams">
                            <h6 class="c-match-item__matchup">
                                {{ match.home_team.name if match.home_team else 'TBD' }} vs {{ match.away_team.name if match.away_team else 'TBD' }}
                            </h6>
                            <div class="c-match-item__time">
                                {% if match.time %}{{ match.time.strftime('%H:%M') }}{% else %}TBD{% endif %}
                            </div>
                        </div>
                        <div class="c-match-item__status">
                            {% if match.home_team_score is not none and match.away_team_score is not none %}
                                <span class="c-badge c-badge--success">{{ match.home_team_score }} - {{ match.away_team_score }}</span>
                            {% else %}
                                <span class="c-badge c-badge--secondary">Finished</span>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="c-empty-state c-empty-state--compact" data-component="empty-state">
                        <i class="ti ti-check c-empty-state__icon"></i>
                        <p class="c-empty-state__text">No completed matches today</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Help Alert -->
<div class="c-panel-section">
    <div class="c-alert c-alert--info">
        <i class="ti ti-info-circle c-alert__icon"></i>
        <div class="c-alert__content">
            <strong>Live Match Monitoring:</strong>
            This page shows all matches scheduled for today. Matches are automatically categorized based on their scheduled time and current status.
        </div>
    </div>
</div>

{% endblock %}
