{% extends "admin_panel/base.html" %}

{% block title %}Draft Management - Admin Panel{% endblock %}

{% block panel_description %}Manage draft history and positions{% endblock %}

{% block breadcrumb_items %}
<li class="breadcrumb-item active">Draft Management</li>
{% endblock %}

{% block panel_content %}
<div class="row">
    <!-- Stats Cards -->
    <div class="col-md-3 col-sm-6 mb-4">
        <div class="card h-100 bg-primary bg-opacity-10">
            <div class="card-body text-center">
                <i class="ti ti-list-numbers fs-1 text-primary mb-2"></i>
                <h3 class="mb-0">{{ stats.total_picks }}</h3>
                <small class="text-muted">Total Draft Picks</small>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-sm-6 mb-4">
        <div class="card h-100 bg-success bg-opacity-10">
            <div class="card-body text-center">
                <i class="ti ti-calendar fs-1 text-success mb-2"></i>
                <h3 class="mb-0">{{ stats.current_season_picks }}</h3>
                <small class="text-muted">Current Season Picks</small>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-sm-6 mb-4">
        <div class="card h-100 bg-info bg-opacity-10">
            <div class="card-body text-center">
                <i class="ti ti-trophy fs-1 text-info mb-2"></i>
                <h3 class="mb-0">{{ stats.seasons_count }}</h3>
                <small class="text-muted">Seasons</small>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-sm-6 mb-4">
        <div class="card h-100 bg-warning bg-opacity-10">
            <div class="card-body text-center">
                <i class="ti ti-users fs-1 text-warning mb-2"></i>
                <h3 class="mb-0">{{ stats.leagues_count }}</h3>
                <small class="text-muted">Leagues</small>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="col-12 mb-4">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="ti ti-bolt me-2"></i>Quick Actions</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4 col-sm-6 mb-3">
                        <a href="{{ url_for('admin_panel.draft_history') }}" class="btn btn-primary w-100">
                            <i class="ti ti-history me-2"></i>View Draft History
                        </a>
                    </div>
                    <div class="col-md-4 col-sm-6 mb-3">
                        <a href="{{ url_for('admin_panel.draft_history', season=current_season.id if current_season else '') }}" class="btn btn-success w-100">
                            <i class="ti ti-calendar me-2"></i>Current Season Draft
                        </a>
                    </div>
                    <div class="col-md-4 col-sm-6 mb-3">
                        <button id="export-btn" class="btn btn-outline-secondary w-100">
                            <i class="ti ti-download me-2"></i>Export Draft Data
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Season/League Selection -->
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0"><i class="ti ti-calendar me-2"></i>Seasons</h5>
            </div>
            <div class="card-body">
                <div class="list-group list-group-flush">
                    {% for season in seasons[:5] %}
                    <a href="{{ url_for('admin_panel.draft_history', season=season.id) }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        <span>
                            {{ season.name }}
                            {% if season.is_current %}
                            <span class="badge bg-success ms-2">Current</span>
                            {% endif %}
                        </span>
                        <i class="ti ti-chevron-right"></i>
                    </a>
                    {% endfor %}
                    {% if seasons|length > 5 %}
                    <a href="{{ url_for('admin_panel.draft_history') }}" class="list-group-item list-group-item-action text-center text-muted">
                        View all {{ seasons|length }} seasons...
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0"><i class="ti ti-trophy me-2"></i>Leagues</h5>
            </div>
            <div class="card-body">
                <div class="list-group list-group-flush">
                    {% for league in leagues[:5] %}
                    <a href="{{ url_for('admin_panel.draft_history', league=league.id) }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        <span>{{ league.name }}</span>
                        <i class="ti ti-chevron-right"></i>
                    </a>
                    {% endfor %}
                    {% if leagues|length > 5 %}
                    <a href="{{ url_for('admin_panel.draft_history') }}" class="list-group-item list-group-item-action text-center text-muted">
                        View all {{ leagues|length }} leagues...
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Information -->
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="ti ti-info-circle me-2"></i>Draft Management Information</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6>Features</h6>
                        <ul class="small text-muted">
                            <li>View draft history by season and league</li>
                            <li>Edit draft pick positions with cascading updates</li>
                            <li>Normalize position gaps automatically</li>
                            <li>Delete and reorder draft picks</li>
                            <li>Export draft data for analysis</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6>Position Editing Modes</h6>
                        <ul class="small text-muted">
                            <li><strong>Cascading:</strong> Shifts all subsequent picks down</li>
                            <li><strong>Absolute:</strong> Sets exact position without shifting</li>
                            <li><strong>Smart:</strong> Automatically determines best approach</li>
                            <li><strong>Insert:</strong> Inserts at position, shifting others</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block custom_js %}
{{ super() }}
<script>
document.getElementById('export-btn').addEventListener('click', function() {
    AdminPanel.showMobileToast('Export functionality coming soon', 'info');
});
</script>
{% endblock %}
