{% extends "admin_panel/base_flowbite.html" %}
{% from 'macros/flowbite.html' import card, button, badge, alert %}

{% block admin_title %}ECS FC Management{% endblock %}
{% block panel_description %}ECS FC club team management hub{% endblock %}

{% block breadcrumb_items %}
<li>
    <div class="flex items-center">
        <i class="ti ti-chevron-right w-4 h-4 text-gray-400"></i>
        <span class="ml-1 text-sm font-medium text-gray-500 dark:text-gray-400">ECS FC Hub</span>
    </div>
</li>
{% endblock %}

{% block panel_content %}
<!-- Quick Actions -->
<div class="bg-white dark:bg-gray-800 rounded-lg shadow mb-6">
    <div class="p-5 border-b border-gray-200 dark:border-gray-700">
        <h5 class="text-lg font-semibold text-gray-900 dark:text-white">
            <i class="ti ti-bolt mr-2"></i>Quick Actions
        </h5>
    </div>
    <div class="p-5">
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <a href="{{ url_for('admin_panel.ecs_fc_match_create') }}" class="flex items-center justify-center px-4 py-3 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700">
                <i class="ti ti-plus mr-2"></i>Create Match
            </a>
            <a href="{{ url_for('admin_panel.ecs_fc_matches') }}" class="flex items-center justify-center px-4 py-3 text-sm font-medium text-white bg-cyan-500 rounded-lg hover:bg-cyan-600">
                <i class="ti ti-list mr-2"></i>All Matches
            </a>
            <a href="{{ url_for('admin_panel.ecs_fc_opponents') }}" class="flex items-center justify-center px-4 py-3 text-sm font-medium text-white bg-green-500 rounded-lg hover:bg-green-600">
                <i class="ti ti-users-group mr-2"></i>Opponents Library
            </a>
            <a href="{{ url_for('admin_panel.ecs_fc_import') }}" class="flex items-center justify-center px-4 py-3 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-600">
                <i class="ti ti-file-import mr-2"></i>Import Schedule
            </a>
        </div>
    </div>
</div>

<!-- Team Cards -->
{% call card(title="ECS FC Teams") %}
{% if teams %}
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
    {% for team in teams %}
    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-5">
        <h5 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">
            <i class="ti ti-shirt-sport text-blue-500 mr-2"></i>{{ team.name }}
        </h5>
        <div class="space-y-2 mb-4">
            <div class="flex justify-between items-center">
                <span class="text-sm text-gray-500 dark:text-gray-400">Upcoming</span>
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300">{{ team_stats[team.id].upcoming_matches }}</span>
            </div>
            <div class="flex justify-between items-center">
                <span class="text-sm text-gray-500 dark:text-gray-400">Pending RSVP</span>
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300">{{ team_stats[team.id].pending_rsvp }}</span>
            </div>
            <div class="flex justify-between items-center">
                <span class="text-sm text-gray-500 dark:text-gray-400">Players</span>
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-300">{{ team_stats[team.id].total_players }}</span>
            </div>
        </div>
        <a href="{{ url_for('admin_panel.ecs_fc_team_schedule', team_id=team.id) }}" class="w-full inline-flex items-center justify-center px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 dark:bg-blue-900/30 dark:text-blue-400 dark:border-blue-800">
            <i class="ti ti-calendar mr-2"></i>View Schedule
        </a>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="text-center py-12">
    <div class="flex items-center justify-center w-16 h-16 mx-auto rounded-full bg-gray-100 dark:bg-gray-700 mb-4">
        <i class="ti ti-mood-empty text-3xl text-gray-400 dark:text-gray-500"></i>
    </div>
    <h5 class="text-lg font-medium text-gray-900 dark:text-white mb-2">No ECS FC Teams Found</h5>
    <p class="text-gray-500 dark:text-gray-400">ECS FC teams are created through League Management</p>
</div>
{% endif %}
{% endcall %}

<!-- Upcoming Matches -->
<div class="bg-white dark:bg-gray-800 rounded-lg shadow">
    <div class="flex items-center justify-between p-5 border-b border-gray-200 dark:border-gray-700">
        <h5 class="text-lg font-semibold text-gray-900 dark:text-white">
            <i class="ti ti-calendar-event mr-2"></i>Upcoming Matches
        </h5>
        <a href="{{ url_for('admin_panel.ecs_fc_matches') }}" class="px-3 py-1.5 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 dark:bg-blue-900/30 dark:text-blue-400 dark:border-blue-800">
            View All
        </a>
    </div>
    {% if upcoming_matches %}
    <div class="overflow-x-auto">
        <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
            <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                <tr>
                    <th scope="col" class="px-4 py-3">Team</th>
                    <th scope="col" class="px-4 py-3">Opponent</th>
                    <th scope="col" class="px-4 py-3">Date & Time</th>
                    <th scope="col" class="px-4 py-3">Location</th>
                    <th scope="col" class="px-4 py-3">RSVP</th>
                    <th scope="col" class="px-4 py-3">Status</th>
                    <th scope="col" class="px-4 py-3">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for match in upcoming_matches %}
                <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <td class="px-4 py-3">
                        <a href="{{ url_for('admin_panel.ecs_fc_team_schedule', team_id=match.team_id) }}" class="font-medium text-blue-600 hover:underline dark:text-blue-400">
                            {{ match.team.name }}
                        </a>
                    </td>
                    <td class="px-4 py-3">
                        <div class="flex items-center">
                            {% if match.is_home_match %}
                            <span class="inline-flex items-center px-2 py-0.5 mr-2 rounded text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300">H</span>
                            {% else %}
                            <span class="inline-flex items-center px-2 py-0.5 mr-2 rounded text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300">A</span>
                            {% endif %}
                            <span class="text-gray-900 dark:text-white">{{ match.opponent_name }}</span>
                        </div>
                    </td>
                    <td class="px-4 py-3">
                        <p class="font-medium text-gray-900 dark:text-white">{{ match.match_date.strftime('%a, %b %d') }}</p>
                        <p class="text-xs text-gray-500 dark:text-gray-400">{{ match.match_time.strftime('%I:%M %p') }}</p>
                    </td>
                    <td class="px-4 py-3">
                        <p class="text-gray-900 dark:text-white">{{ match.location }}</p>
                        {% if match.field_name %}
                        <p class="text-xs text-gray-500 dark:text-gray-400">{{ match.field_name }}</p>
                        {% endif %}
                    </td>
                    <td class="px-4 py-3">
                        <div class="flex gap-1">
                            <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300" title="Yes">{{ match.rsvp_counts.yes }}</span>
                            <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300" title="No">{{ match.rsvp_counts.no }}</span>
                            <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300" title="Maybe">{{ match.rsvp_counts.maybe }}</span>
                        </div>
                    </td>
                    <td class="px-4 py-3">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium {{ 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300' if match.status_color == 'success' else 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300' if match.status_color == 'warning' else 'bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-300' if match.status_color == 'info' else 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300' }}">
                            <i class="{{ match.status_icon }} mr-1"></i>{{ match.status }}
                        </span>
                    </td>
                    <td class="px-4 py-3">
                        <div class="flex items-center gap-1">
                            <a href="{{ url_for('admin_panel.ecs_fc_rsvp_status', match_id=match.id) }}" class="p-2 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded-lg" title="View RSVP">
                                <i class="ti ti-users"></i>
                            </a>
                            <a href="{{ url_for('admin_panel.ecs_fc_match_edit', match_id=match.id) }}" class="p-2 text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg" title="Edit">
                                <i class="ti ti-edit"></i>
                            </a>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="text-center py-12">
        <div class="flex items-center justify-center w-16 h-16 mx-auto rounded-full bg-gray-100 dark:bg-gray-700 mb-4">
            <i class="ti ti-calendar-off text-3xl text-gray-400 dark:text-gray-500"></i>
        </div>
        <h5 class="text-lg font-medium text-gray-900 dark:text-white mb-2">No Upcoming Matches</h5>
        <p class="text-gray-500 dark:text-gray-400 mb-4">Create a new match to get started</p>
        <a href="{{ url_for('admin_panel.ecs_fc_match_create') }}" class="inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700">
            <i class="ti ti-plus mr-2"></i>Create Match
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}
